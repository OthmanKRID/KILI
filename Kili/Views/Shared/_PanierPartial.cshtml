@using Kili.Helpers
@using Kili.Models.Services
@using Kili.Models.Vente
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@{
    var panierID = SessionHelper.GetObjectFromJson<int>(HttpContextAccessor.HttpContext.Session, "panierID");
    Panier panier = (panierID != 0) ? new PanierServices().ObtenirPanier(panierID) : new Panier() { Articles = new List<Article>() };
}
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
        <span class="lnr lnr-cart"></span>
        @if (panier.Articles.Count > 0)
        {
            <span class="badge badge-bg-1">@(panier.Articles.Sum(article => article.Quantite))</span>
        }
        else
        {
            <span class="badge badge-bg-1">0</span>
        }
    </a>
    @if (panier.Articles.Count > 0)
    {
        <ul class="dropdown-menu cart-list s-cate">

            @foreach (var article in panier.Articles)
            {
                <li class="single-cart-list">
                    <a href="#" class="photo"><img src="@article.Produit.ImagePath" class="cart-thumb" alt="image" /></a>
                    <div class="cart-list-txt">
                        <h6><a href="#">@article.Produit.Designation</a></h6>
                        <p>@article.Quantite x - <span class="price">@article.Produit.PrixUnitaire @article.Produit.Devise</span></p>
                    </div><!--/.cart-list-txt-->
            <div class="cart-close">
                        <span class="lnr lnr-cross"></span>
                    </div><!--/.cart-close-->
        </li>
                <!--/.single-cart-list -->
            }
            <li class="total">
                <span>Total: @(panier.Articles.Sum(article => article.Produit.PrixUnitaire * article.Quantite)) &euro;</span>
                <button class="btn-cart pull-right" onclick="window.location.href='#'">view cart</button>
            </li>
        </ul>
    }

</li>